webpackJsonp([9],{Iz4A:function(e,t){},wqDb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("fZjL"),o=a.n(i),l=a("//Fk"),s=a.n(l),n=a("gyMJ"),r={components:{pagination:a("spLH").a},data:function(){return{rule:{roleName:[{required:!0,message:"请输入角色名称",tigger:"blur"}]},disable:!1,defaultProps:{children:"children",label:"label"},loading2:!0,page:{pageNum:10,currentPage:1,pageSize:5},tempData:{},serData:{roleName:""},editorRoleData:{id:"",visability:!1,roleName:"",description:""},editorData:{id:"",visability:!1,dataList:[],selectedList:[]},addRoleData:{visability:!1,roleName:"",description:""},roleDataList:[],allDataList:[]}},methods:{searchList:function(){this.serData=this.$common.deepCopy(this.tempData),this.page.currentPage=1,this.initData(1)},submit:function(){var e=this;this.$refs.editorForm.validate(function(t){console.log(t),t&&n.c.editorRoleMessage({id:e.editorRoleData.id,description:e.editorRoleData.description,roleName:e.editorRoleData.roleName}).then(function(t){"success"===t.msg?(e.$message.success("修改信息成功"),e.clearMessage(e.editorRoleData),e.close(),e.initData()):e.$message("修改信息失败")})})},sizeChange:function(e){this.page.pageSize=e,this.page.currentPage=1,this.initData(1)},currentChange:function(e){this.page.currentPage=e,this.initData()},editor:function(e){var t=this,a=this;a.editorData.id=e,n.c.limitList({sysRoleId:e}).then(function(e){a.initList(e),a.editorData.visability=!0}).then(function(){a.$refs.tree.setCheckedNodes(t.editorData.selectedList)})},clearTree:function(){this.$refs.tree.setCheckedNodes([])},changeRight:function(){var e=this,t=[];this.$refs.tree.getCheckedNodes().forEach(function(e){t.push(e.id)}),n.c.editorRole({id:this.editorData.id,sysMenuIds:t}).then(function(t){e.close()})},initList:function(e){var t=this;e.children.forEach(function(e){var a={label:e.text,id:e.id,children:e.children,open:e.state.selected};t.editorData.dataList.push(a)}),t.editorData.dataList.forEach(function(e){var a=[];e.children.forEach(function(e){var i={label:e.text,id:e.id,open:e.state.selected};!0===i.open&&t.editorData.selectedList.push(i),a.push(i)}),e.children=a})},add:function(){this.addRoleData.visability=!0},close:function(){var e=this,t=this;this.clearMessage(this.addRoleData),new s.a(function(e,a){t.editorRoleData.visability=!1,t.addRoleData.visability=!1,t.editorData.visability=!1,t.disable=!0,setTimeout(function(){e()},1e3)}).then(function(){t.disable=!1,e.editorData.selectedList=[],e.editorData.dataList=[]})},del:function(e,t){var a=this,i=this;n.c.delRole({id:e}).then(function(e){"success"===e.msg?(a.roleDataList.splice(t,1),i.$message.success("删除成功")):i.$message.error(e.msg)})},upLoad:function(){var e=this,t=this;""===this.addRoleData.roleName?this.$message.error("角色名不能为空"):n.c.addRole({roleName:this.addRoleData.roleName,description:this.addRoleData.description}).then(function(a){e.clearMessage(e.addRoleData),e.close(),t.initData()})},editorRoleMessage:function(e,t,a){this.editorRoleData.id=e,this.editorRoleData.roleName=t,this.editorRoleData.description=a,this.editorRoleData.visability=!0},clearMessage:function(e){o()(e).forEach(function(t){e[t]=""})},initData:function(e,t){var a=this,i=this;i.loading2=!0,n.c.roleList({page:e||this.page.currentPage,size:t||this.page.pageSize,roleName:i.serData.roleName}).then(function(e){a.roleDataList=e.rows,a.page.pageNum=e.count}).then(function(){setTimeout(function(){i.loading2=!1},500)})}},beforeMount:function(){this.initData()}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content clearfix roleMessage"},[a("div",{staticClass:"operation"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:e.tempData.roleName,callback:function(t){e.$set(e.tempData,"roleName",t)},expression:" tempData.roleName"}},[a("template",{slot:"prepend"},[e._v("角色名称")])],2)],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"50px"},attrs:{type:"info",icon:"el-icon-search"},on:{click:e.searchList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("添加")])],1)],1),e._v(" "),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],staticClass:"mgt20",attrs:{data:e.roleDataList}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"150",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),e._v(" "),a("el-table-column",{attrs:{label:"权限设置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:e.disable},on:{click:function(a){e.editor(t.row.id)}}},[e._v("权限设置")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(a){e.editorRoleMessage(t.row.id,t.row.roleName,t.row.description)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){e.del(t.row.id,t.row.$index)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("pagination",{attrs:{"current-page":e.page.currentPage,"page-size":e.page.pageSize,total:e.page.pageNum},on:{sizeChange:e.sizeChange,currentChange:e.currentChange}}),e._v(" "),a("el-dialog",{attrs:{placement:"top-start",width:"400px",visible:e.addRoleData.visability,title:"添加角色",transition:"fade-in-linear","modal-append-to-body":!1,"show-close":!1}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:e.addRoleData.roleName,callback:function(t){e.$set(e.addRoleData,"roleName",t)},expression:"addRoleData.roleName"}},[a("template",{attrs:{placeholder:"不能为空"},slot:"prepend"},[e._v("角色名称")])],2)],1)],1),e._v(" "),a("el-row",{staticClass:"mgt20"},[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"textarea",size:"medium",placeholder:"请输入对该角色的描述(可以为空)"},model:{value:e.addRoleData.description,callback:function(t){e.$set(e.addRoleData,"description",t)},expression:"addRoleData.description"}})],1)],1),e._v(" "),a("div",{staticClass:"mgt20 button-box"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.upLoad}},[e._v("上传")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){e.clearMessage(e.addRoleData)}}},[e._v("清空")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1)],1),e._v(" "),a("el-dialog",{attrs:{placement:"top-start",width:"600px",visible:e.editorData.visability,title:"角色权限编辑",transition:"fade-in-linear","modal-append-to-body":!1,"show-close":!1,setChecked:"node"}},[a("el-tree",{ref:"tree",attrs:{accordion:"",data:e.editorData.dataList,"show-checkbox":"","node-key":"id","highlight-current":"",props:e.defaultProps}}),e._v(" "),a("div",{staticClass:"mgt20 button-box"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.changeRight}},[e._v("保存信息")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.clearTree}},[e._v("清空")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.close}},[e._v("关闭")])],1)],1),e._v(" "),a("el-dialog",{attrs:{placement:"top-start",width:"400",visible:e.editorRoleData.visability,title:"角色权限编辑",transition:"fade-in-linear","modal-append-to-body":!1,"show-close":!1,setChecked:"node"}},[a("el-row",[a("el-form",{ref:"editorForm",attrs:{model:e.editorRoleData,rules:e.rule}},[a("el-form-item",[a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{disabled:""},model:{value:e.editorRoleData.id,callback:function(t){e.$set(e.editorRoleData,"id",t)},expression:"editorRoleData.id"}},[a("template",{attrs:{placeholder:"不能为空"},slot:"prepend"},[e._v("角色id")])],2)],1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"roleName"}},[a("el-col",{staticClass:"mgt20  clearfix",attrs:{span:18}},[a("el-input",{model:{value:e.editorRoleData.roleName,callback:function(t){e.$set(e.editorRoleData,"roleName",t)},expression:" editorRoleData.roleName"}},[a("template",{attrs:{placeholder:"不能为空"},slot:"prepend"},[e._v("角色名称")])],2)],1)],1),e._v(" "),a("el-input",{staticClass:"mgt20",attrs:{type:"textarea",size:"medium",placeholder:"请输入对该角色的描述(可以为空)"},model:{value:e.editorRoleData.description,callback:function(t){e.$set(e.editorRoleData,"description",t)},expression:"editorRoleData.description"}}),e._v(" "),a("div",{staticClass:"mgt20 button-box"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.submit}},[e._v("上传")]),e._v(" "),a("el-button",{attrs:{type:"danger",con:"el-icon-delete"},on:{click:e.close}},[e._v("关闭")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(e){a("Iz4A")},"data-v-d2222a3a",null);t.default=d.exports}});
//# sourceMappingURL=9.4037694aace8f5dff51f.js.map